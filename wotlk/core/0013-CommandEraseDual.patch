From 968b7bfc908688b8bfa37a3d7b6b0578fd9e29a4 Mon Sep 17 00:00:00 2001
From: 4m1g0 <casadelblanco@gmail.com>
Date: Sat, 7 Jan 2012 00:33:01 +0100
Subject: [PATCH 13/22] Command-Erase-Dual

---
 null                                     |    4 ++--
 src/server/game/Chat/Chat.cpp            |    1 +
 src/server/game/Chat/Chat.h              |    1 +
 src/server/game/Chat/Commands/Level3.cpp |   23 +++++++++++++++++++++++
 4 files changed, 27 insertions(+), 2 deletions(-)

diff --git a/null b/null
index 8cb788b..8d0bdfc 100644
--- a/null
+++ b/null
@@ -1,2 +1,2 @@
-[master 22edbb4] 2-DisableChatNotifications
- 2 files changed, 6 insertions(+), 6 deletions(-)
+[master d977ec0] Command-Disable
+ 2 files changed, 4 insertions(+), 2 deletions(-)
diff --git a/src/server/game/Chat/Chat.cpp b/src/server/game/Chat/Chat.cpp
index 035fbaf..acc38e5 100755
--- a/src/server/game/Chat/Chat.cpp
+++ b/src/server/game/Chat/Chat.cpp
@@ -367,6 +367,7 @@ ChatCommand* ChatHandler::getCommandTable()
         { "itemmove",       SEC_GAMEMASTER,     false, OldHandler<&ChatHandler::HandleItemMoveCommand>,            "", NULL },
         { "cooldown",       SEC_ADMINISTRATOR,  false, OldHandler<&ChatHandler::HandleCooldownCommand>,            "", NULL },
         { "unlearn",        SEC_ADMINISTRATOR,  false, OldHandler<&ChatHandler::HandleUnLearnCommand>,             "", NULL },
+        { "erasedual",      SEC_ADMINISTRATOR,  false, OldHandler<&ChatHandler::HandleEraseDualCommand>,           "", NULL },
         { "distance",       SEC_ADMINISTRATOR,  false, OldHandler<&ChatHandler::HandleGetDistanceCommand>,         "", NULL },
         { "recall",         SEC_MODERATOR,      false, OldHandler<&ChatHandler::HandleRecallCommand>,              "", NULL },
         { "save",           SEC_PLAYER,         false, OldHandler<&ChatHandler::HandleSaveCommand>,                "", NULL },
diff --git a/src/server/game/Chat/Chat.h b/src/server/game/Chat/Chat.h
index 2311f4b..330d6ce 100755
--- a/src/server/game/Chat/Chat.h
+++ b/src/server/game/Chat/Chat.h
@@ -275,6 +275,7 @@ class ChatHandler
 
         bool HandleCooldownCommand(const char* args);
         bool HandleUnLearnCommand(const char* args);
+        bool HandleEraseDualCommand(const char* /*args*/);
         bool HandleGetDistanceCommand(const char* args);
         bool HandleDieCommand(const char* args);
         bool HandleDamageCommand(const char *args);
diff --git a/src/server/game/Chat/Commands/Level3.cpp b/src/server/game/Chat/Commands/Level3.cpp
index f7af3db..77b10c4 100755
--- a/src/server/game/Chat/Commands/Level3.cpp
+++ b/src/server/game/Chat/Commands/Level3.cpp
@@ -174,6 +174,29 @@ bool ChatHandler::HandleUnLearnCommand(const char *args)
     return true;
 }
 
+bool ChatHandler::HandleEraseDualCommand(const char* /*args*/)
+{
+    Player* target = getSelectedPlayer();
+
+    if (!target)
+    {
+        SendSysMessage(LANG_NO_CHAR_SELECTED);
+        SetSentErrorMessage(true);
+        return false;
+    }
+
+    if (target->HasSpell(63645))
+        target->removeSpell(63645, false, false);
+
+    if (target->HasSpell(63644))
+        target->removeSpell(63644, false, false);
+
+    target->GetSession()->GetPlayer()->ActivateSpec(0);
+    target->GetSession()->GetPlayer()->UpdateSpecCount(1);
+
+    return true;
+}
+
 bool ChatHandler::HandleCooldownCommand(const char *args)
 {
     Player* target = getSelectedPlayer();
-- 
1.7.5.4

