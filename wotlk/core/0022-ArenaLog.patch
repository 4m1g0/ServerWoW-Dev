From fecb49e35e6d16e7167f66ab94b510b4c863fd59 Mon Sep 17 00:00:00 2001
From: 4m1g0 <casadelblanco@gmail.com>
Date: Tue, 31 Jan 2012 18:34:01 +0100
Subject: [PATCH 22/26] ArenaLog

---
 src/server/game/Battlegrounds/Battleground.cpp |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/src/server/game/Battlegrounds/Battleground.cpp b/src/server/game/Battlegrounds/Battleground.cpp
index 5d12186..4500fe3 100755
--- a/src/server/game/Battlegrounds/Battleground.cpp
+++ b/src/server/game/Battlegrounds/Battleground.cpp
@@ -754,6 +754,10 @@ void Battleground::EndBattleground(uint32 winner)
                     for (Battleground::BattlegroundScoreMap::const_iterator itr = GetPlayerScoresBegin(); itr != GetPlayerScoresEnd(); ++itr)
                         if (Player* player = ObjectAccessor::FindPlayer(itr->first))
                             sLog->outArena("Statistics for %s (GUID: " UI64FMTD ", Team: %d, IP: %s): %u damage, %u healing, %u killing blows", player->GetName(), itr->first, player->GetArenaTeamId(m_ArenaType == 5 ? 2 : m_ArenaType == 3), player->GetSession()->GetRemoteAddress().c_str(), itr->second->DamageDone, itr->second->HealingDone, itr->second->KillingBlows);
+
+                // Guardamos los de arena en tabla logs
+                CharacterDatabase.PExecute("INSERT INTO `logs` (type, param1, param2, param3, param4, param5, param6) VALUES (2, %u, %d, %d, %d, %d, %d)", m_ArenaType, winner_arena_team->GetId(), loser_arena_team->GetId(), winner_team_rating, loser_team_rating, GetStartTime());
+
             }
             // Deduct 16 points from each teams arena-rating if there are no winners after 45+2 minutes
             else
-- 
1.7.5.4

